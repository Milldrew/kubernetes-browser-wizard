<div class="cluster-ip-info">
  <h2>Cluster Node Information</h2>

  <!-- Add New Node Form -->
  <div class="add-node-form">
    <h3>Add New Node</h3>
    <div class="form-row">
      <label for="nickname">Nickname (optional):</label>
      <input
        id="nickname"
        type="text"
        [(ngModel)]="newNode.nickname"
        placeholder="e.g., master-01, worker-beta"
        class="nickname-input"
      />
      
      <label for="ipAddress">IP Address:</label>
      <input
        id="ipAddress"
        type="text"
        [(ngModel)]="newNode.ipAddress"
        placeholder="Example: 192.168.1.100"
        class="ip-input"
      />

      <label for="nodeType">Node Type:</label>
      <select id="nodeType" [(ngModel)]="newNode.nodeType" class="node-type-select">
        <option value="worker">Worker Node</option>
        <option value="control-plane">Control Plane Node</option>
      </select>

      <label for="username">SSH Username:</label>
      <input
        id="username"
        type="text"
        [(ngModel)]="newNode.username"
        placeholder="e.g., ubuntu, root"
        class="username-input"
      />

      <label for="password">SSH Password:</label>
      <input
        id="password"
        type="password"
        [(ngModel)]="newNode.password"
        placeholder="SSH password"
        class="password-input"
      />

      <label for="isConfigured" class="checkbox-label">
        <input
          id="isConfigured"
          type="checkbox"
          [(ngModel)]="newNode.isConfigured"
          class="configured-checkbox"
        />
        Is Configured
      </label>

      <button (click)="addNode()" class="add-button">Add Node</button>
    </div>
  </div>

  <!-- Nodes Table -->
  @if (nodes.length > 0) {
    <div class="nodes-table-container">
      <h3>Cluster Nodes</h3>
      <table class="nodes-table">
        <thead>
          <tr>
            <th>Nickname</th>
            <th>IP Address</th>
            <th>Node Type</th>
            <th>Username</th>
            <th>Password</th>
            <th>Configured</th>
            <th>SSH Command</th>
            <th>Actions</th>
          </tr>
        </thead>
        <tbody>
          @for (node of nodes; track node.id) {
            <tr class="node-row">
              <td>
                @if (node.isEditing) {
                  <input
                    type="text"
                    [(ngModel)]="node.nickname"
                    class="edit-input"
                    placeholder="Nickname"
                  />
                } @else {
                  <span class="node-nickname">
                    {{ node.nickname || '-' }}
                  </span>
                }
              </td>
              <td>
                @if (node.isEditing) {
                  <input
                    type="text"
                    [(ngModel)]="node.ipAddress"
                    class="edit-input"
                  />
                } @else {
                  <span 
                    class="copyable-ip" 
                    (click)="copyToClipboard(node.ipAddress, $event)"
                    title="Click to copy IP address"
                  >
                    {{ node.ipAddress }}
                  </span>
                }
              </td>
              <td>
                @if (node.isEditing) {
                  <select
                    [(ngModel)]="node.nodeType"
                    class="edit-select"
                  >
                    <option value="worker">Worker Node</option>
                    <option value="control-plane">Control Plane Node</option>
                  </select>
                } @else {
                  <span class="node-type" [class.worker]="node.nodeType === 'worker'" [class.control-plane]="node.nodeType === 'control-plane'">
                    {{ node.nodeType === 'worker' ? 'Worker Node' : 'Control Plane Node' }}
                  </span>
                }
              </td>
              <td>
                @if (node.isEditing) {
                  <input
                    type="text"
                    [(ngModel)]="node.username"
                    class="edit-input"
                    placeholder="Username"
                  />
                } @else {
                  <span class="node-username">
                    {{ node.username || '-' }}
                  </span>
                }
              </td>
              <td>
                @if (node.isEditing) {
                  <input
                    type="password"
                    [(ngModel)]="node.password"
                    class="edit-input"
                    placeholder="Password"
                  />
                } @else {
                  <span class="node-password">
                    {{ node.password ? '••••••••' : '-' }}
                  </span>
                }
              </td>
              <td>
                @if (node.isEditing) {
                  <input
                    type="checkbox"
                    [(ngModel)]="node.isConfigured"
                    class="edit-checkbox"
                  />
                } @else {
                  <span class="configured-status" [class.configured]="node.isConfigured">
                    {{ node.isConfigured ? '✓' : '✗' }}
                  </span>
                }
              </td>
              <td>
                @if (!node.isEditing && generateSshCommand(node)) {
                  <span 
                    class="copyable-ip" 
                    (click)="copyToClipboard(generateSshCommand(node), $event)"
                    title="Click to copy SSH command"
                  >
                    {{ generateSshCommand(node) }}
                  </span>
                } @else {
                  <span class="no-ssh">-</span>
                }
              </td>
              <td class="actions">
                @if (node.isEditing) {
                  <div>
                    <button (click)="saveNode(node)" class="save-button">Save</button>
                    <button (click)="cancelEdit(node)" class="cancel-button">Cancel</button>
                  </div>
                } @else {
                  <button (click)="editNode(node)" class="edit-button">Edit</button>
                  <button (click)="deleteNode(node.id)" class="delete-button">Delete</button>
                }
              </td>
            </tr>
          }
        </tbody>
      </table>
    </div>
  }

  @if (nodes.length === 0) {
    <div class="empty-state">
      <p>No cluster nodes configured yet. Add your first node above.</p>
    </div>
  }
</div>
